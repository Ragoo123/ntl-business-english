{% load static %}

<div class="card shadow-lg border-0 rounded-xl my-4 bg-light">
	<div class="card-body text-center shadow-sm p-4 d-flex flex-column justify-content-between rounded-xl border border-3 border-primary-custom">
		<!-- Header -->
		<div class="text-muted mb-3 d-flex justify-content-between gap-3">
			<span class="px-3 py-2 rounded-xl shadow-sm bg-secondary-custom text-light"> Quiz: Listening: {{ folder_name }} </span>
			<span class="px-3 py-2 rounded-xl shadow-sm bg-primary-custom text-light"> Question {{ quiz_index }} / {{ total_questions }} </span>
			<span class="px-3 py-2 rounded-xl shadow-sm bg-success text-light"> Score: {{ quiz_score }} </span>
		</div>

		<!-- Audio -->
		<div class="mb-4 px-3 py-3 rounded-xxl shadow-sm bg-white border">
			<audio controls class="w-100">
				<source src="{{ current_audio_quiz.audio_file.url }}" />
			</audio>
		</div>

		<!-- Transcript -->
		{% if current_audio_quiz.transcript %}
		<div class="mb-4 text-start">
			<details class="rounded-xl border p-3 bg-light">
				<summary class="fw-bold">Show transcript</summary>
				<p class="mt-3 mb-0">{{ current_audio_quiz.transcript }}</p>
			</details>
		</div>
		{% endif %}

		<!-- Question -->
		<h3 class="mb-4 mt-2 px-3 py-4 rounded-xxl text-white shadow-sm bg-primary-custom">{{ current_question.question_text }}</h3>

		<!-- Options -->
		<div class="row g-4">
			{% for option in options %}
			<div
				class="col-12 col-sm-6 col-lg-3 d-flex"
				hx-post="{% url 'check_answer' %}"
				hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}'
				hx-vals='{
          "option_id": "{{ option.id }}",
          "question_id": "{{ current_question.id }}"
        }'
				hx-target="#quizArea"
				hx-swap="innerHTML transition:true"
			>
				<div class="choice-option is-interactive flex-fill d-flex align-items-center justify-content-center">
					<p>{{ option.option_text }}</p>
				</div>
			</div>
			{% endfor %}
		</div>
	</div>
</div>
