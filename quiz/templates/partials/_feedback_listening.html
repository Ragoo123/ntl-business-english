{% load static %}

<div class="card shadow-lg border-0 rounded-xl my-4 bg-light">
  <div class="card-body text-center shadow-sm p-4 d-flex flex-column justify-content-between rounded-xl border border-3 border-primary-custom">

    <!-- Header -->
    <div class="text-muted mb-3 d-flex justify-content-between gap-3">
      <span class="px-3 py-2 rounded-xl shadow-sm bg-secondary-custom text-light">
        Quiz: Listening: {{ folder_name }}
      </span>
      <span class="px-3 py-2 rounded-xl shadow-sm bg-primary-custom text-light">
        Question {{ quiz_index }} / {{ total_questions }}
      </span>
      <span class="px-3 py-2 rounded-xl shadow-sm bg-success text-light">
        Score: {{ quiz_score }}
      </span>
    </div>

    <!-- ðŸ”Š Audio -->
    <div class="mb-4 px-3 py-3 rounded-xxl shadow-sm bg-white border">
      <audio controls class="w-100">
        <source src="{{ audio_url }}">
        Your browser does not support the audio element.
      </audio>
    </div>

    <!-- ðŸ“„ Transcript -->
    {% if audio_transcript %}
    <div class="mb-4 text-start">
      <details class="rounded-xl border p-3 bg-light">
        <summary class="fw-bold cursor-pointer">Show transcript</summary>
        <p class="mt-3 mb-0">{{ audio_transcript }}</p>
      </details>
    </div>
    {% endif %}

    <!-- Question -->
    <h3 class="mb-4 mt-2 px-3 py-4 rounded-xxl text-white shadow-sm bg-primary-custom">
      {{ current_question.question_text }}
    </h3>

    <!-- Options -->
    <div class="row g-4">
      {% for option in options %}
      <div class="col-12 col-sm-6 col-lg-3 d-flex">
        <div
          class="choice-option flex-fill d-flex align-items-center justify-content-center
          {% if option.id == selected_option and option.id == correct_option_id %}
            bg-success text-white
          {% elif option.id == selected_option %}
            bg-danger text-white
          {% elif option.id == correct_option_id %}
            bg-success text-white
          {% endif %}"
        >
          <p>{{ option.text }}</p>
        </div>
      </div>
      {% endfor %}
    </div>

  </div>
</div>

<!-- Auto load next question -->
<div
  id="nextQuestion"
  hx-post="{% url 'load_next_question_listening' %}"
  hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}'
  hx-target="#quizArea"
  hx-swap="innerHTML transition:true"
  hx-trigger="load delay:1.5s once"
></div>




